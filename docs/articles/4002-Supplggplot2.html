<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Supplemental: ggplot2 • useR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Supplemental: ggplot2">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">useR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2019.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    Getting Started
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/SomeBackground.html">README 1st: Some Background</a>
    </li>
    <li>
      <a href="../articles/GetStarted.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/InstallR-RStudio.html">Install R and RStudio</a>
    </li>
    <li>
      <a href="../articles/InstallJava.html">Install 64--bit Java on Windows Systems</a>
    </li>
    <li>
      <a href="../articles/ObtainCourseMaterial.html">Obtain Course Material</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    RMarkdown
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/0201-rmdIntro.html">RMarkdown: Introduction</a>
    </li>
    <li>
      <a href="../articles/0202-rmdGetStarted.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/0203-rmdBuildingBlocks.html">RMarkdown Building Blocks</a>
    </li>
    <li>
      <a href="../articles/0204-rmdKNIT.html">KNIT the RMarkdown</a>
    </li>
    <li>
      <a href="../articles/0205-rmdGetCreative.html">Building Creative Documents</a>
    </li>
    <li>
      <a href="../articles/0206-rmdEmbedCode.html">Embed and Execute R Code</a>
    </li>
    <li>
      <a href="../articles/0207-rmdFinalExample.html">EXAMPLE: Finalized Document</a>
    </li>
    <li>
      <a href="../articles/0208-rmdAdditionalTopics.html">Some Additional Topics</a>
    </li>
    <li>
      <a href="../articles/0209-rmdPDFOutput.html">PDF Output from RMarkdown</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    baseR
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Intro.html">XXIntroduction</a>
    </li>
    <li>
      <a href="../articles/Mod01.html">XXModule 1</a>
    </li>
    <li>
      <a href="../articles/Mod02.html">XXModule 2</a>
    </li>
    <li>
      <a href="../articles/Mod03.html">XXModule 3</a>
    </li>
    <li>
      <a href="../articles/Mod04.html">XXModule 4</a>
    </li>
    <li>
      <a href="../articles/Mod05.html">XXModule 5</a>
    </li>
    <li>
      <a href="../articles/Appendices.html">XXAppendices</a>
    </li>
    <li>
      <a href="../articles/4001-SupplDateTime.html">Supplemental: Date and Time</a>
    </li>
    <li>
      <a href="../articles/4002-Supplggplot2.html">Supplemental: ggplot2</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    sdhmR
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/sdhmR-Introduction.html">XXIntroduction to SDHM</a>
    </li>
    <li>
      <a href="../articles/sdhmR-SetGoals.html">XXEstablishing SDHM Goals</a>
    </li>
    <li>
      <a href="../articles/sdhmR-DataAcqVetOrganize.html">XXData Acquisition, Vetting, and Organization</a>
    </li>
    <li>
      <a href="../articles/sdhmR-ModConstruct.html">XXModel Construction</a>
    </li>
    <li>
      <a href="../articles/sdhmR-ModAssess.html">XXModel Assessment</a>
    </li>
    <li>
      <a href="../articles/sdhmR-Ensembles.html">XXEnsemble SDHMs</a>
    </li>
    <li>
      <a href="../articles/sdhmR-FieldCampaigns.html">XXField Campaigns for SDHMs</a>
    </li>
    <li>
      <a href="../articles/sdhmR-ImplementSDHM.html">XXSDHM Implementation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    gisToolsR
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/gisR-Intro.html">XXIntroduction: GIS Using R</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Supplemental: ggplot2</h1>
            
      
      
      <div class="hidden name"><code>4002-Supplggplot2.rmd</code></div>

    </div>

    
    
<!--
---
title: "ggplot2: An Alternative to R Base Plots"
output:
  bookdown::pdf_document2:
    fig_caption: yes
    toc: false
    toc_depth: 3
    keep_tex: TRUE
    number_sections: yes
  bookdown::html_document2:
    fig_caption: yes
    highlight: haddock
    number_sections: yes
    toc: yes
    toc_depth: 3
    toc_float: yes
urlcolor: blue
---
-->
<!-- set root directory here -->
<p>Last update: 30 August 2019 (V2019.2)</p>
<hr>
<div id="purpose-of-this-vignette" class="section level2">
<h2 class="hasAnchor">
<a href="#purpose-of-this-vignette" class="anchor"></a>Purpose of this Vignette</h2>
<p>This vignette describes how to use the package <code>ggplot2</code> to build four basic types of graphs commonly used in biological reports:</p>
<ul>
<li>Scatterplots
<ul>
<li>Relate an x to a y, as in correlation or regression</li>
</ul>
</li>
<li>Line plots
<ul>
<li>Relate change in y per change in x</li>
<li>Typically used to show change in a y over some steps in x, as in a time series plot; Think “connect the dots” plots</li>
</ul>
</li>
<li>Bar charts
<ul>
<li>A response in y where x is discrete, as in frequencies of observations by classes</li>
</ul>
</li>
<li>Histograms
<ul>
<li>A response in y where a continuous x</li>
<li>x is binned during histogram construction, as in frequencies of observations by bin</li>
</ul>
</li>
</ul>
<p>The code below mimics code using base plot in R and is designed as a Supplemental to Module 5, baseR.</p>
<p><strong>Bypass the Webpage:</strong></p>
<ul>
<li><p>Click here to <a href="https://maddoor1.nr.usu.edu:45231/sharing/dT62HxRgE">download and obtain a PDF</a> of this vignette.</p></li>
<li><p>Click here to <a href="https://maddoor1.nr.usu.edu:45231/sharing/dT62HxRgE">download and obtain a PDF</a> of this vignette.</p></li>
</ul>
</div>
<div id="introduction-to-package-ggplot2" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction-to-package-ggplot2" class="anchor"></a>Introduction to Package <code>ggplot2</code>
</h2>
<p>The package <a href="https://ggplot2.tidyverse.org/"><code>ggplot2</code></a> is an alternative to the base plotting functions described in Module 5, baseR. <code>ggplot</code> is based on so–called “grammar of graphics,” a phrase coined by L. Wilkinson and subsequently incorporated into the <code>ggplot2</code> package by Wickham and others. It relies on three core layers of information beginning with the data, a second labeled aesthetics, which essentially is how the coded data will be portrayed, and last a set of geometries, which defines the properties of the lines, bars, and points used in the graph.</p>
<p>To many, <code>ggplot2</code> plot defaults are more “eye pleasing” and, in the case of complex plots, often requires simpler coding to construct the graph.</p>
<p>Advantages notwithstanding, <code>ggplot2</code> still draws on may of the same plot symbologies found in R base plots, containing analogs to <code>pch</code>, <code>col</code>, <code>cex</code>, and well as others. In short, if you can conceptualize and build a graph using R base plots you can also build a graph using <code>ggplot2</code>. Which you use is a matter of personal choice only.</p>
<p>Irrespective of the desired plotting approach – R base graphics, <code>ggplot</code>, or others such as <code>lattice</code> – plot construction still requires careful thinking of how the information is to be presented in a graphical format. After that it merely a matter of coding.</p>
<div id="some-base-elements-of-ggplot2" class="section level3">
<h3 class="hasAnchor">
<a href="#some-base-elements-of-ggplot2" class="anchor"></a>Some Base Elements of <code>ggplot2</code>
</h3>
<p>The library <code>ggplot2</code> is required. An important option to consider when using <code>ggplot2</code> is <code>ggthemes</code>, a set of canned backgrounds that can be applied to <code>ggplot2</code>–based graphs. The “grammar of graphics” approach is based on the addition of layers of information that are individually plotted and when combined create the graph. Each of these layers is connected by the <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> (plus) symbol.</p>
<p>The examples below show the corresponding <code>ggplot2</code> code that mimic, to a large extent, the graphs constructed using R base plots, Module 5.</p>
<hr>
</div>
</div>
<div id="the-ggplot2-scatterplot" class="section level2">
<h2 class="hasAnchor">
<a href="#the-ggplot2-scatterplot" class="anchor"></a>The <code>ggplot2</code> Scatterplot</h2>
<div id="the-data-and-rationale-for-graph" class="section level3">
<h3 class="hasAnchor">
<a href="#the-data-and-rationale-for-graph" class="anchor"></a>The Data and Rationale for Graph</h3>
<p>Data used for a basic scatterplot is found in <strong>sculpin_eggs.csv</strong>. These data represent the number of eggs produced in relation to the weight of female sculpin Cabezon, <em>Scorpaenichthys marmoratus</em> (Ayres). The objective of the graph is to show the relationship between the two variables, and add both a straight line through the points, as well as a locally weighted scatterplot smoother (LOWESS) line. Data characteristics are shown below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(s1)  <span class="co"># examine characteristics</span></a></code></pre></div>
<pre><code>## 'data.frame':    11 obs. of  2 variables:
##  $ weight: int  14 17 24 25 27 33 34 37 40 41 ...
##  $ eggs  : int  61 37 65 69 54 93 87 89 100 90 ...</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(s1, <span class="dv">2</span>)  <span class="co"># examine observations</span></a></code></pre></div>
<pre><code>##   weight eggs
## 1     14   61
## 2     17   37</code></pre>
</div>
<div id="building-the-graph" class="section level3">
<h3 class="hasAnchor">
<a href="#building-the-graph" class="anchor"></a>Building the Graph</h3>
<p><code>aea</code> is a central call to <code>ggplot2</code>. The <code>aes</code> sets the plot relationship, while <code>geom_point</code> defines how the points are plotted. Note that although <code>ggplot2</code> uses <code>size =</code> and <code>shape =</code> for point characteristics, these are identical to the <code>pch =</code> and <code>cex =</code> symbology. In fact, the latter two can used in place of <code>size</code> and <code>shape</code>. <code>labs())</code> simply places the <code>ylab</code> and <code>xlab</code> commands inside a single call. Again, <code>labs()</code> can be replaced with separate <code>xlab</code> and <code>ylab</code> calls. The <code>geom_smooth</code> options are analogous to <code>lines</code> and <code>abline</code>. Note the <code>se=</code> TRUE or FALSE option. The <code>theme</code> call is used to add plot titles.</p>
<p>Figure output is below (Fig. @ref(fig:f01)).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># simple scatterplot</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="kw">ggplot</span>(s1, <span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> eggs)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">shape =</span> <span class="dv">16</span>) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"No. Eggs"</span>, <span class="dt">y =</span> <span class="st">"Weight (g)"</span>) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">"No. Eggs in Relation to Weight"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">14</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm, <span class="dt">se =</span> F, <span class="dt">color =</span> <span class="st">"black"</span>) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> F, <span class="dt">color =</span> <span class="st">"black"</span>, <span class="dt">linetype =</span> <span class="dv">2</span>)  </a></code></pre></div>
<pre><code>## `geom_smooth()` using method = 'loess' and formula 'y ~ x'</code></pre>
<div class="figure" style="text-align: center">
<img src="4002-Supplggplot2_files/figure-html/f01-1.png" alt="Basic scatterplot." width="75%"><p class="caption">
Basic scatterplot.
</p>
</div>
<hr>
</div>
</div>
<div id="the-ggplot2-line-graph-1" class="section level2">
<h2 class="hasAnchor">
<a href="#the-ggplot2-line-graph-1" class="anchor"></a>The <code>ggplot2</code> Line Graph 1</h2>
<div id="the-data-and-rationale-for-graph-1" class="section level3">
<h3 class="hasAnchor">
<a href="#the-data-and-rationale-for-graph-1" class="anchor"></a>The Data and Rationale for Graph</h3>
<p>Data for generating a line graph represent counts of male greater sage-grouse <em>Centrocercus urophasianus</em> at numerous lek sites in western North America over the course of several years. Leks are locations where females gather and males compete for females through a variety of complex behavioral displays. Objective of the graph is to display raw counts of males over time (year) by different leks. Thus, multiple lines representing unique lek locations will all be plotted together. The data, <strong>grouse_lekmales.csv</strong>, are imported as object <strong>g1</strong>. Note that the data contain missing values as blanks in the <strong>.csv</strong> file; consequently the option <code>na.strings = ""</code> is invoked during data import. Data characteristics are shown below.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(g1)  <span class="co"># examine characteristics</span></a></code></pre></div>
<pre><code>## 'data.frame':    108 obs. of  3 variables:
##  $ complex: Factor w/ 9 levels "AM","BC","BM",..: 8 9 1 2 5 7 6 3 4 8 ...
##  $ year   : int  1996 1996 1996 1996 1996 1996 1996 1996 1996 1997 ...
##  $ males  : int  5 15 7 40 8 31 166 25 32 9 ...</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(g1, <span class="dv">2</span>)  <span class="co"># examine observations</span></a></code></pre></div>
<pre><code>##   complex year males
## 1      SF 1996     5
## 2      SS 1996    15</code></pre>
</div>
<div id="building-the-graph-1" class="section level3">
<h3 class="hasAnchor">
<a href="#building-the-graph-1" class="anchor"></a>Building the Graph</h3>
<p>Like R base plots, <code>ggplot2</code> allows for data subsetting within the <code>ggplot()</code> call. Here we subset a group of factor levels from the variable <code>complex</code>, and specify a <code>group =</code> option. This breaks the plotting into levels as characterized by the variable <code>complex</code>. Note that <code>geom_line</code> and <code>geom_point</code> use the group values to automatically assign point and line types. A quirk of <code>ggplot2</code> is that integers plot as numeric even if the variable R class is integer; if the intent is portray integers as as discrete levels (e.g., year) on an axis then coerce them to class Factor.</p>
<p>Legends, like plot titles, are constructed using <code>theme</code>. The options <code>legend.direction</code> and <code>legend.justification</code> position the legend. <code>scale_shape_discrete</code> and <code>scale_linetype_discrete</code> plot the legend symbology. Both are required in plots where points are combined with lines. Running only one of these will result in two separate legends being plotted.</p>
<p>Check out the graph (Fig. @ref(fig:f02)).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># line graph</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw">ggplot</span>(<span class="dt">data=</span><span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(g1,g1<span class="op">$</span>complex <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"DM"</span>,<span class="st">"BM"</span>,<span class="st">"SS"</span>,<span class="st">"HH"</span>)), </a>
<a class="sourceLine" id="cb11-3" title="3">  <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(year), <span class="dt">y =</span> males, <span class="dt">group =</span> complex)) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Year"</span>, <span class="dt">y =</span> <span class="st">"Number of Males"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> complex)) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> complex)) <span class="op">+</span><span class="st">   </span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.direction =</span> <span class="st">"horizontal"</span>, <span class="dt">legend.position =</span> <span class="st">"top"</span>, </a>
<a class="sourceLine" id="cb11-8" title="8">  <span class="dt">legend.box =</span> <span class="st">"horizontal"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.justification=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">5</span>,<span class="dv">1</span>), <span class="dt">legend.position=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">5</span>,<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="st"> </span><span class="kw">scale_shape_discrete</span>(<span class="dt">name=</span><span class="st">"Complex"</span>) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="st"> </span><span class="kw">scale_linetype_discrete</span>(<span class="dt">name=</span><span class="st">"Complex"</span>) </a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="4002-Supplggplot2_files/figure-html/f02-1.png" alt="Basic line graph with multiple lines." width="75%"><p class="caption">
Basic line graph with multiple lines.
</p>
</div>
<hr>
</div>
</div>
<div id="the-ggplot2-line-graph-2" class="section level2">
<h2 class="hasAnchor">
<a href="#the-ggplot2-line-graph-2" class="anchor"></a>The <code>ggplot2</code> Line Graph 2</h2>
<div id="the-data-and-rationale-for-graph-2" class="section level3">
<h3 class="hasAnchor">
<a href="#the-data-and-rationale-for-graph-2" class="anchor"></a>The Data and Rationale for Graph</h3>
<p>Two age classes (old, young) of penned coyotes were given one of three possible drug treatments (A, B, C) designed to reduce stress under penned circumstances. Stress was measured as blood enzyme levels. Objective of the graph is to plot treatment blood enzyme means in relation to age class, and provide a visualization of whether interaction effects exist. Data come from <strong>coyote_drugs.csv</strong> and are imported as <strong>c1</strong>. Data characteristics are then examined as precursors to building the graph.</p>
<p>Although possible to extract the mean values from an ANOVA output for direct incorporation into the plot, we calculate means here using <code><a href="https://rdrr.io/r/stats/aggregate.html">aggregate()</a></code>. Next, floor and ceiling of the response range is determined, and will then be used to set the <em>y</em>–axis limits. Different line types and symbols are applied to the two age classes.</p>
<p>Data modes are correct as Factor with appropriate levels for the variables <strong>drugtype</strong> and <strong>age</strong>, while blood enzyme measures <strong>bloodlev</strong> are numeric.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(c1)  <span class="co"># examine characteristics</span></a></code></pre></div>
<pre><code>## 'data.frame':    18 obs. of  3 variables:
##  $ age     : Factor w/ 2 levels "old","yng": 1 1 1 1 1 1 1 1 1 2 ...
##  $ drugtype: Factor w/ 3 levels "a","b","c": 1 1 1 2 2 2 3 3 3 1 ...
##  $ bloodlev: num  86.9 91 90.1 92.2 90.5 91.5 93.1 90.6 91.4 89.9 ...</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(c1, <span class="dv">2</span>)  <span class="co"># examine observations</span></a></code></pre></div>
<pre><code>##   age drugtype bloodlev
## 1 old        a     86.9
## 2 old        a     91.0</code></pre>
<p>Next, calculate the means and determine the floor and ceiling.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># determine means of treatment combos</span></a>
<a class="sourceLine" id="cb16-2" title="2">c2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span>(c1<span class="op">$</span>bloodlev, <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">age =</span> c1<span class="op">$</span>age, </a>
<a class="sourceLine" id="cb16-3" title="3"> <span class="dt">drugtype =</span> c1<span class="op">$</span>drugtype), <span class="dt">FUN =</span> <span class="st">"mean"</span>)</a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co"># determine range (as integers) of means for use in plot</span></a>
<a class="sourceLine" id="cb16-5" title="5">resp.r &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Round.html">floor</a></span>(c2<span class="op">$</span>x)), <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(c2<span class="op">$</span>x)))</a></code></pre></div>
</div>
<div id="building-the-graph-2" class="section level3">
<h3 class="hasAnchor">
<a href="#building-the-graph-2" class="anchor"></a>Building the Graph</h3>
<p>This plot uses many of the <code>ggplot2</code> plot elements shown above for Fig. @ref(fig:f02). The first of these is assigning labels to the <em>x</em>—axis. Other modification show how to manually assign point shape and line type, a title to the legend, and labels to the legend elements. This is accomplished using the <code>scale_shape_manual</code> and <code>scale_linetype_manual</code> options (Fig. @ref(fig:f03)).</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co"># plot of factorial experiment; line plot w/age=old</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="kw">ggplot</span>(c2, <span class="kw">aes</span>(<span class="dt">x =</span> drugtype, <span class="dt">y =</span> x, <span class="dt">group =</span> age)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> age)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> age), <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Treatment"</span>, <span class="dt">y =</span> <span class="st">"Mean Blood Enzyme Level"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="st"> </span><span class="kw">scale_shape_manual</span>(<span class="dt">name=</span><span class="st">"Age"</span>, <span class="dt">values =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">15</span>, <span class="dv">17</span>), </a>
<a class="sourceLine" id="cb17-8" title="8">  <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Old"</span>, <span class="st">"Young"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="st"> </span><span class="kw">scale_linetype_manual</span>(<span class="dt">name =</span> <span class="st">"Age"</span>, <span class="dt">values =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb17-10" title="10">  <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Old"</span>, <span class="st">"Young"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"gray90"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-12" title="12"><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.justification =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">25</span>, <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb17-13" title="13">  <span class="dt">legend.position =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">25</span>, <span class="dv">1</span>))</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="4002-Supplggplot2_files/figure-html/f03-1.png" alt="Basic line graph for a simple ANOVA." width="75%"><p class="caption">
Basic line graph for a simple ANOVA.
</p>
</div>
<hr>
</div>
</div>
<div id="the-ggplot2-bar-chart-1" class="section level2">
<h2 class="hasAnchor">
<a href="#the-ggplot2-bar-chart-1" class="anchor"></a>The <code>ggplot2</code> Bar Chart 1</h2>
<div id="the-data-and-rationale-for-graph-3" class="section level3">
<h3 class="hasAnchor">
<a href="#the-data-and-rationale-for-graph-3" class="anchor"></a>The Data and Rationale for Graph</h3>
<p>Male and female osprey <em>Pandion halieatus</em> were observed foraging at a lake, with an objective of determining the frequency three separate fish species groups were captured by each sex. Although multiple fish species comprised each group, identification to the species levels was difficult and it was determined that group at eh genus level was sufficient. Objective of the graph is to show the capture frequencies cross–classified by sex within fish species groups. The actual counts by each of the six bars (two sexes <span class="math inline">\(\times\)</span> three fish groups) was to be included on the top of each bar in the graph. Data come from <strong>ospreypreybysex.csv</strong> and are imported as <strong>f1</strong>. Data characteristics are then examined as precursors to building the graph.</p>
<p>Data as imported are already in a matrix format, with the counts by the six possible levels already determined. Thus, no cross–tabulation (i.e., <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> call) to generate the counts is required. Data are also properly configured with appropriate class of Factor for both osprey sex (<strong>ospreysex</strong>) and fish species group (<strong>fishspp</strong>). <strong>count</strong>, the number of captures, is of class integer.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(f1)  <span class="co"># data characteristics</span></a></code></pre></div>
<pre><code>## 'data.frame':    6 obs. of  3 variables:
##  $ ospreysex: Factor w/ 2 levels "Female","Male": 2 1 2 1 2 1
##  $ fishspp  : Factor w/ 3 levels "Bass","Shad",..: 3 3 1 1 2 2
##  $ count    : int  59 72 14 21 189 138</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">f1  <span class="co"># examine data matrix</span></a></code></pre></div>
<pre><code>##   ospreysex fishspp count
## 1      Male Sunfish    59
## 2    Female Sunfish    72
## 3      Male    Bass    14
## 4    Female    Bass    21
## 5      Male    Shad   189
## 6    Female    Shad   138</code></pre>
</div>
<div id="building-the-graph-3" class="section level3">
<h3 class="hasAnchor">
<a href="#building-the-graph-3" class="anchor"></a>Building the Graph</h3>
<p>Bar charts are built using <code>geom_bar</code>. It defaults to counts and should not be used to plot continuous data. Similar to data organization required for construction of Figure FIG 050505, data for a bar chart needs to be summarized into a column of counts with the associated Factor levels. The <code>aes(fishspp, count, fill = ospreysex)</code> configures the plot as <strong>ospreysex</strong> within the levels of <strong>fishspp</strong>. Reversing the <strong>fishspp</strong> and <strong>ospreysex</strong> within the <code>aes()</code> plots levels of <strong>fishspp</strong> within <strong>ospreysex</strong>. An alternative to <code>geom_bar</code> is <code>geom_col</code>. The call <code>scale_fill_manual</code> manually assigns legend title and color to the legend elements. One new addition is the<code>geom_text</code>. This call adds the numeric values (here, the variable <code>count</code>) to the bars in the plot. <code>vjust =</code> as a positive or negative value places the numeric values above or within the bar, respectively (Fig. @ref(fig:f04)).</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># plot everything</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">ggplot</span>(f1, <span class="kw">aes</span>(fishspp, count, <span class="dt">fill =</span> ospreysex)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> ospreysex), <span class="dt">position =</span> <span class="st">"dodge"</span>, </a>
<a class="sourceLine" id="cb22-4" title="4">  <span class="dt">stat=</span><span class="st">"identity"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Osprey Sex"</span>, <span class="dt">y =</span> <span class="st">"Capture Frequency (n)"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-6" title="6"><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">name =</span> <span class="st">"Fish Species"</span>, </a>
<a class="sourceLine" id="cb22-7" title="7">  <span class="dt">values =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"grey60"</span>, <span class="st">"grey40"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-8" title="8"><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"gray90"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-9" title="9"><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.justification =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb22-10" title="10">  <span class="dt">legend.position =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-11" title="11"><span class="st"> </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> count), <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.9</span>), </a>
<a class="sourceLine" id="cb22-12" title="12">  <span class="dt">vjust =</span> <span class="fl">-.5</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="4002-Supplggplot2_files/figure-html/f04-1.png" alt="Basic bar chart of fish species captures by osprey sex." width="75%"><p class="caption">
Basic bar chart of fish species captures by osprey sex.
</p>
</div>
<hr>
</div>
</div>
<div id="the-ggplot2-bar-chart-2" class="section level2">
<h2 class="hasAnchor">
<a href="#the-ggplot2-bar-chart-2" class="anchor"></a>The <code>ggplot2</code> Bar Chart 2</h2>
<div id="the-data-and-rationale-for-graph-4" class="section level3">
<h3 class="hasAnchor">
<a href="#the-data-and-rationale-for-graph-4" class="anchor"></a>The Data and Rationale for Graph</h3>
<p>Six conifer species comprise the bulk of tree species in the pinon–juniper woodlands of western North America, including two pines, <em>Pinus edulis</em>, <em>P. monosperma</em>, and four junipers, <em>Juniperous deppeana</em>, <em>J. monosperma</em>, <em>J. occidentalis</em>, and <em>J. osteosperma</em>. As part of a larger study exploring potential climate change effects on the distributions of the species and woodlands they constitute, data on presence – absence locations of the tree species in relation to current annual temperature was required. These location data were then used to extract annual temperature from a GIS–based map of temperatures. Data from <strong>conifer_anntemps.csv</strong> are to be imported as t1 and a bar chart constructed showing mean annual temperature by presence – absence location within each tree species. Error bars (standard deviation) are to be added to the bar chart as well. The imported data object is examined prior to constructing the graph.</p>
<p>Data as imported already contain mean (<strong>xbar</strong>), n (<strong>n</strong>), and standard deviation (<strong>sd</strong>) and error (<strong>se</strong>) values. Note that variable <strong>presab</strong> is of class integer. For the plot to be built, <strong>presab</strong> must be coerced to <code>class=factor</code>, either during data import or by use of <code><a href="https://rdrr.io/r/base/factor.html">as.factor()</a></code> during the grpah construction. The example below coerces using the <code><a href="https://rdrr.io/r/base/factor.html">as.factor()</a></code> call.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(t1)  <span class="co"># data characteristics</span></a></code></pre></div>
<pre><code>## 'data.frame':    12 obs. of  7 variables:
##  $ spp   : Factor w/ 6 levels "jude","jumo",..: 1 1 2 2 3 3 4 4 5 5 ...
##  $ presab: int  0 1 0 1 0 1 0 1 0 1 ...
##  $ n     : int  4780 441 5305 748 3758 664 13764 2265 9226 1999 ...
##  $ xbar  : num  13.22 10.71 11.8 10.32 9.07 ...
##  $ sd1   : num  4.49 2.29 4.56 2.44 4.41 ...
##  $ var1  : num  2013 523 2076 593 1949 ...
##  $ se    : num  0.649 1.089 0.626 0.891 0.72 ...</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(t1, <span class="dv">2</span>)  <span class="co"># examine observations</span></a></code></pre></div>
<pre><code>##    spp presab    n     xbar      sd1      var1        se
## 1 jude      0 4780 13.22201 4.487018 2013.3328 0.6489987
## 2 jude      1  441 10.71442 2.287374  523.2081 1.0892259</code></pre>
<p>The formula <code>xbar ~ presab + spp</code> within <code><a href="https://rdrr.io/r/stats/xtabs.html">xtabs()</a></code> configures the data as tree species presence – absence by each tree species. The response <strong>xbar</strong> will become the plot value for the y–axis. You could easily swap out any of the other numeric values (e.g., <strong>sd</strong>) in the original <strong>t1</strong> dataframe in place of <strong>xbar</strong>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co"># reconfigure data matrix using xtabs</span></a>
<a class="sourceLine" id="cb27-2" title="2">t2.xbar &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/xtabs.html">xtabs</a></span>(xbar <span class="op">~</span><span class="st"> </span>presab <span class="op">+</span><span class="st"> </span>spp, t1)) </a>
<a class="sourceLine" id="cb27-3" title="3"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(t2.xbar, <span class="dv">2</span>)  <span class="co"># compare t2 format with t1</span></a></code></pre></div>
<pre><code>##   presab  spp     Freq
## 1      0 jude 13.22201
## 2      1 jude 10.71442</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(t2.xbar) <span class="co"># examine</span></a></code></pre></div>
<pre><code>## 'data.frame':    12 obs. of  3 variables:
##  $ presab: Factor w/ 2 levels "0","1": 1 2 1 2 1 2 1 2 1 2 ...
##  $ spp   : Factor w/ 6 levels "jude","jumo",..: 1 1 2 2 3 3 4 4 5 5 ...
##  $ Freq  : num  13.22 10.71 11.8 10.32 9.07 ...</code></pre>
</div>
<div id="building-the-graph-4" class="section level3">
<h3 class="hasAnchor">
<a href="#building-the-graph-4" class="anchor"></a>Building the Graph</h3>
<p>We used <code>geom_bar</code> in the <code>ggplot2</code> above, but that is restricted to count data. Use <code>geom_col</code> if the response data (i.e., <em>y</em>–axis) are of continuous scale. the <code>position="dodge"</code> options creates hsitgrams by groups, whihc in this example are based on the two levels [0,1] in the varibale <strong>presabs</strong>. Note also the inclusion of the <code><a href="https://rdrr.io/r/base/expression.html">expression()</a></code> call in <code>labs()</code>. Thus, <code>ggplot2</code> affords the same option to include mathematical and special character symbols in plot axes labels. Error bars are added using <code>geom_errorbar</code>, where the <code>ymin</code> and <code>ymax</code> values are the mean <span class="math inline">\(\pm\)</span> the desired measure of dispersion. <code>width =</code> determines the width of the error bar. Output is below (Fig. @ref(fig:f05)).</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">ggplot</span>(t1, <span class="kw">aes</span>(<span class="dt">x =</span> spp, <span class="dt">y =</span> xbar, <span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(presab))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="st"> </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(presab)), <span class="dt">position =</span> <span class="st">"dodge"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-3" title="3"><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Tree Species Code"</span>, </a>
<a class="sourceLine" id="cb31-4" title="4">  <span class="dt">y =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="st">"Mean Annual Temperature ( "</span> <span class="op">*</span><span class="st"> </span>degree <span class="op">*</span><span class="st"> "C)"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-5" title="5"><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">name =</span> <span class="st">"Species Status"</span>, </a>
<a class="sourceLine" id="cb31-6" title="6">  <span class="dt">values =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"grey60"</span>, <span class="st">"grey40"</span>), </a>
<a class="sourceLine" id="cb31-7" title="7">  <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Present"</span>, <span class="st">"Absent"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-8" title="8"><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"JUDE"</span>, <span class="st">"JUMO"</span>, <span class="st">"JUOC"</span>, <span class="st">"JUOS"</span>, </a>
<a class="sourceLine" id="cb31-9" title="9">                             <span class="st">"PIED"</span>, <span class="st">"PIMO"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-10" title="10"><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"gray90"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-11" title="11"><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.justification =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">5</span>,<span class="dv">1</span>), </a>
<a class="sourceLine" id="cb31-12" title="12">  <span class="dt">legend.position =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(.<span class="dv">5</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-13" title="13"><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> xbar<span class="op">-</span>se, <span class="dt">ymax =</span> xbar<span class="op">+</span>se), <span class="dt">width =</span> <span class="fl">.2</span>, </a>
<a class="sourceLine" id="cb31-14" title="14">  <span class="dt">position =</span> <span class="kw">position_dodge</span>(.<span class="dv">9</span>))</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="4002-Supplggplot2_files/figure-html/f05-1.png" alt="Basic bar chart climate relations for six tree species" width="75%"><p class="caption">
Basic bar chart climate relations for six tree species
</p>
</div>
<hr>
</div>
</div>
<div id="the-ggplot2-complex-stack" class="section level2">
<h2 class="hasAnchor">
<a href="#the-ggplot2-complex-stack" class="anchor"></a>The <code>ggplot2</code> Complex Stack</h2>
<div id="the-data-and-rationale-for-graph-5" class="section level3">
<h3 class="hasAnchor">
<a href="#the-data-and-rationale-for-graph-5" class="anchor"></a>The Data and Rationale for Graph</h3>
<p>As part of an analysis to determine if morphometric measurements differed between sexes in the common western jumping mouse <em>Zapus princeps princeps</em>, skull measurements from museum specimens were measured. One of these measurements was the incisive foramina width, which is a measure of the width of a canal behind the incisors on the roof of the mouth. Blood vessels and nerves pass through this canal. A histogram of the widths by sex was requested.</p>
<p>For ease of interpretation, the two histograms are to be stacked on one another, sharing a common <em>x</em>–axis representing the maximum and minimum measurements irrespective of sex. Data come from <strong>zapusmorph_bysex.csv</strong> and are imported as <strong>z1</strong>. The incisive foramina width is coded as <strong>ifwid</strong>.</p>
<p>The imported dataframe contains numerous other morphometric variables and identifying variables.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(z1)  <span class="co"># data names</span></a></code></pre></div>
<pre><code>##  [1] "catno"   "sex"     "conlen"  "zygbre"  "lstiob"  "lstibw"  "masma"  
##  [8] "palbre"  "pallen"  "utrlen"  "lmtrlen" "iflen"   "ifwid"   "pm4wid" 
## [15] "lm1fold" "lm3wear"</code></pre>
<p>The two required variables <strong>sex</strong> and <strong>ifwid</strong>, are the appropriate <code>class=</code> (<code>factor</code> and <code>numeric</code>, respectively) for the constructing the histogram.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(z1[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"sex"</span>, <span class="st">"ifwid"</span>)], <span class="dv">2</span>) <span class="co"># examine onservations</span></a></code></pre></div>
<pre><code>##   sex ifwid
## 1   F  1.88
## 2   M  2.04</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(z1[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"sex"</span>, <span class="st">"ifwid"</span>)])</a></code></pre></div>
<pre><code>## 'data.frame':    35 obs. of  2 variables:
##  $ sex  : Factor w/ 2 levels "F","M": 1 2 1 2 2 2 2 1 2 2 ...
##  $ ifwid: num  1.88 2.04 2.1 1.94 1.98 1.97 1.92 2.06 2.12 2.16 ...</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(z1<span class="op">$</span>ifwid)</a></code></pre></div>
<pre><code>## [1] "numeric"</code></pre>
<p>Potential modification to the histograms include a stacking process that results in less whitespace between the two histograms, common <em>x</em>– and <em>y</em>–axes, and inclusion of “smoother” lines fitted to the data.</p>
</div>
<div id="building-the-graph-5" class="section level3">
<h3 class="hasAnchor">
<a href="#building-the-graph-5" class="anchor"></a>Building the Graph</h3>
<p><code>ggplot2</code> is simpler than R base plots for stacking plots with common <em>x</em>– and <em>y</em>–axis labels, with the exception of labeling the subplots. Calling <code>facet_grid</code> creates multiple plots (i.e., facets) based on factor levels where <code>sex ~ .</code> relates the levels of sex to the <code>aes(x = )</code> call. <code>scales = "fixed"</code> ensures axis values are identical on the separate plots.</p>
<p>Surprisingly there is no simple away to change facet labels; they default to the data coding, which is of class Factor. While complex processes exist within <code>ggplot2</code> to change labels, the simplest approach is to re–label the factor levels in the data, as shown below. These new labels are then applied to the facets using the <code>labeller=label_value</code> option. Facet labels obviate the need for a legend so it is suppressed by setting <code>guides(fill=F)</code>.</p>
<p>Output is below (Fig. @ref(fig:f06)).</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">z1<span class="op">$</span>sex &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(z1<span class="op">$</span>sex, <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>))</a>
<a class="sourceLine" id="cb40-2" title="2"><span class="co"># stacked histograms for variable ifwid with common axis labels</span></a>
<a class="sourceLine" id="cb40-3" title="3"><span class="kw">ggplot</span>(z1, <span class="kw">aes</span>(<span class="dt">x=</span>ifwid, <span class="dt">fill=</span>sex)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-4" title="4"><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">9</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-5" title="5"><span class="st"> </span><span class="kw">facet_grid</span>(sex <span class="op">~</span><span class="st"> </span>., <span class="dt">scales =</span> <span class="st">"fixed"</span>, <span class="dt">labeller=</span>label_value) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-6" title="6"><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"IFWID length (mm)"</span>, <span class="dt">y =</span> <span class="st">"Frequency"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-7" title="7"><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">name =</span> <span class="st">"Sex"</span>, <span class="dt">values =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"grey60"</span>, <span class="st">"grey40"</span>),</a>
<a class="sourceLine" id="cb40-8" title="8">  <span class="dt">labels=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-9" title="9"><span class="st"> </span><span class="kw">guides</span>(<span class="dt">fill=</span>F)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="4002-Supplggplot2_files/figure-html/f06-1.png" alt="Complex stack of histograms." width="75%"><p class="caption">
Complex stack of histograms.
</p>
</div>
</div>
</div>
<div id="some-concluding-thoughts" class="section level2">
<h2 class="hasAnchor">
<a href="#some-concluding-thoughts" class="anchor"></a>Some Concluding Thoughts</h2>
<p>How you construct plots in R is entirely up to you. If you are “new” to R, it might be best to begin with <code>ggplot2</code>, mostly because many of the graph examples you will find on the Web were built with <code>ggplot2</code>.</p>
<p>However, in the grand scheme of research and reprt writing it matters not one whit how you construct plots, as long as they look professional and are repeatable. From my perspective as an instructor for this and other courses I teach, I care only that the plot has been correctly built and the intended message is clear.</p>
<p>How you build it is left up to you. That’s what cool about R – you decide what to use to meet your analytical goals.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#purpose-of-this-vignette">Purpose of this Vignette</a></li>
      <li><a href="#introduction-to-package-ggplot2">Introduction to Package <code>ggplot2</code></a></li>
      <li><a href="#the-ggplot2-scatterplot">The <code>ggplot2</code> Scatterplot</a></li>
      <li><a href="#the-ggplot2-line-graph-1">The <code>ggplot2</code> Line Graph 1</a></li>
      <li><a href="#the-ggplot2-line-graph-2">The <code>ggplot2</code> Line Graph 2</a></li>
      <li><a href="#the-ggplot2-bar-chart-1">The <code>ggplot2</code> Bar Chart 1</a></li>
      <li><a href="#the-ggplot2-bar-chart-2">The <code>ggplot2</code> Bar Chart 2</a></li>
      <li><a href="#the-ggplot2-complex-stack">The <code>ggplot2</code> Complex Stack</a></li>
      <li><a href="#some-concluding-thoughts">Some Concluding Thoughts</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Thomas Edwards.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
