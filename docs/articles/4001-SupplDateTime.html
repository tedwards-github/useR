<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Supplemental: Date and Time • useR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Supplemental: Date and Time">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">useR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2019.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    Getting Started
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/0101-gsSomeBackground.html">README 1st: Some Background</a>
    </li>
    <li>
      <a href="../articles/0102-gsGetStarted.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/0103-gsInstallR-RStudio.html">Install R and RStudio</a>
    </li>
    <li>
      <a href="../articles/0104-gsInstallJava.html">Install 64--bit Java on Windows Systems</a>
    </li>
    <li>
      <a href="../articles/0105-gsObtainCourseMaterial.html">Obtain Course Material</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    RMarkdown
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/0201-rmdIntro.html">RMarkdown: Introduction</a>
    </li>
    <li>
      <a href="../articles/0202-rmdGetStarted.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/0203-rmdBuildingBlocks.html">RMarkdown Building Blocks</a>
    </li>
    <li>
      <a href="../articles/0204-rmdKNIT.html">KNIT the RMarkdown</a>
    </li>
    <li>
      <a href="../articles/0205-rmdGetCreative.html">Building Creative Documents</a>
    </li>
    <li>
      <a href="../articles/0206-rmdEmbedCode.html">Embed and Execute R Code</a>
    </li>
    <li>
      <a href="../articles/0207-rmdFinalExample.html">EXAMPLE: Finalized Document</a>
    </li>
    <li>
      <a href="../articles/0208-rmdAdditionalTopics.html">Some Additional Topics</a>
    </li>
    <li>
      <a href="../articles/0209-rmdPDFOutput.html">PDF Output from RMarkdown</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    baseR
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Intro.html">XXIntroduction</a>
    </li>
    <li>
      <a href="../articles/Mod01.html">XXModule 1</a>
    </li>
    <li>
      <a href="../articles/Mod02.html">XXModule 2</a>
    </li>
    <li>
      <a href="../articles/Mod03.html">XXModule 3</a>
    </li>
    <li>
      <a href="../articles/Mod04.html">XXModule 4</a>
    </li>
    <li>
      <a href="../articles/Mod05.html">XXModule 5</a>
    </li>
    <li>
      <a href="../articles/Appendices.html">XXAppendices</a>
    </li>
    <li>
      <a href="../articles/4001-SupplDateTime.html">Supplemental: Date and Time</a>
    </li>
    <li>
      <a href="../articles/4002-Supplggplot2.html">Supplemental: ggplot2</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    sdhmR
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/sdhmR-Introduction.html">XXIntroduction to SDHM</a>
    </li>
    <li>
      <a href="../articles/sdhmR-SetGoals.html">XXEstablishing SDHM Goals</a>
    </li>
    <li>
      <a href="../articles/sdhmR-DataAcqVetOrganize.html">XXData Acquisition, Vetting, and Organization</a>
    </li>
    <li>
      <a href="../articles/sdhmR-ModConstruct.html">XXModel Construction</a>
    </li>
    <li>
      <a href="../articles/sdhmR-ModAssess.html">XXModel Assessment</a>
    </li>
    <li>
      <a href="../articles/sdhmR-Ensembles.html">XXEnsemble SDHMs</a>
    </li>
    <li>
      <a href="../articles/sdhmR-FieldCampaigns.html">XXField Campaigns for SDHMs</a>
    </li>
    <li>
      <a href="../articles/sdhmR-ImplementSDHM.html">XXSDHM Implementation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    gisToolsR
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/gisR-Intro.html">XXIntroduction: GIS Using R</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Supplemental: Date and Time</h1>
            
      
      
      <div class="hidden name"><code>4001-SupplDateTime.rmd</code></div>

    </div>

    
    
<!--
---
title: "Thoughts on Using Date and Time in R"
output:
  bookdown::pdf_document2:
    fig_caption: yes
    toc: false
    toc_depth: 3
    keep_tex: TRUE
    number_sections: yes
  bookdown::html_document2:
    fig_caption: yes
    highlight: haddock
    number_sections: yes
    toc: yes
    toc_depth: 3
    toc_float: yes
urlcolor: blue
---
-->
<!-- set root directory here -->
<p>Last update: 10 September 2019 (V2019.2)</p>
<hr>
<div id="purpose-of-this-vignette" class="section level2">
<h2 class="hasAnchor">
<a href="#purpose-of-this-vignette" class="anchor"></a>Purpose of this Vignette</h2>
<p>This vignette explores some of the nuances associated with the use of date and / or time in R. It serves as a Supplemental to baseR, Module 3.3, Specialized Data Distinctions.</p>
<p><strong>Bypass the Webpage:</strong></p>
<ul>
<li>Click here to <a href="https://maddoor1.nr.usu.edu:45231/sharing/qW2WcdAFs">download and obtain a PDF</a> of this vignette.</li>
</ul>
<hr>
</div>
<div id="why-use-rbased-date-and-time-values" class="section level2">
<h2 class="hasAnchor">
<a href="#why-use-rbased-date-and-time-values" class="anchor"></a>Why Use R–based Date and Time Values?</h2>
<p>Most ecological data has date and / or time values associated with measurements. Some examples might include GPS–collars on ungulates, which collect data on the date and time an individual is recorded at a particular geographic location, or pit tags in fish which record a date or date and time when a fish migrates through a stream and past a recorder. Other examples are a bit more mundane, such as field sample dates, or re–visit dates to a sample point associated with an occupancy modelling effort on birds. Irrespective of intent, all still involve collection and analysis of date and / or time.</p>
<p>The bottom line: we record date and / or time for a host of reasons that aid us in analysis and interpretation, and storing date and / or time as R–based values is to your advantage.</p>
<p>R–based date and time formats have the advantage of allowing for arithmetic operations, mostly where you determine date or time intervals via addition or subtraction. R, in fact, also has a several built–in functions that perform these as well as other operations, such as determining Julian dates. Some examples of where this could be useful would determining re–sight date intervals for a Mark–Recapture study, or time intervals of behavioral actions performed by animals.</p>
</div>
<div id="the-datetime-conversion-process-in-r" class="section level2">
<h2 class="hasAnchor">
<a href="#the-datetime-conversion-process-in-r" class="anchor"></a>The Date:Time Conversion Process in R</h2>
<p>The conversion of externally recorded dates and times into R–based formats can be complex, and careful attention must be paid to formats of raw data input, how those data are imported and how R internally views the imported data, and what the desired outcome and application of the R–based date and time formats is to be.</p>
<p>Most of us (for better or worse) use MS Excel for data entry and storage. Being proprietary software, MS Office products store date and time <em>per</em> the software, a form of data formatting that does not necessarily “talk” well with R and how R stores date and time. Moreover, dates and times can be entered into a standard <code>.csv/.xlsx/.xls</code> spreadsheets in many different forms, some of which for date are shown in the Fig. @ref(fig:fig01) below. (To see more date and time options available in Excel, go to HOME =&gt; Number =&gt; Number tab =&gt; Date.)</p>
<!-- ![](figures/dateformats.png){width=480px} --->
<div class="figure" style="text-align: center">
<img src="figures/dateformats.png" alt="Date and time format options in MS EXCEL" width="50%" style="background-color: #ffffff; padding:10px; display: inline-block;"><p class="caption">
Date and time format options in MS EXCEL
</p>
</div>
<p>Although R has options to import data from many different types of data structures, the two file types most commonly imported into R are <code>.csv</code> or <code>.xlsx/.xls</code>. Each of these file types stores dates and times in visually similar formats, but importing date and time from from each results in different data characteristics (i.e., <code>class</code>) in R. You need to understand these source file–specific effects before importing dates and times.</p>
<p>Last, it is good idea to have some expectation of how the R–formatted dates and times is to be used, such as whether the entire spectrum of options ranging from years to seconds, including variants such as time zone and daylight savings effects, to simply concentrating on days alone.</p>
<p>Consequently, three issues to consider before proceeding to work with date and time in R are:</p>
<ul>
<li>The originating file type being imported into R;</li>
<li>The raw (import) data format(s); and</li>
<li>What are to be some eventual operations performed on the dates and times.</li>
</ul>
<p>We’ll begin with <code>.csv</code> file imports and then consider imports of <code>.xlsx/.xls</code> files. As you will see below, some R date and time functions work irrespective of the import file type, and some are particular to file type.</p>
<hr>
</div>
<div id="importing-date-and-time-from--csv-files" class="section level2">
<h2 class="hasAnchor">
<a href="#importing-date-and-time-from--csv-files" class="anchor"></a>Importing Date and Time from .csv Files</h2>
<p>The imported <code>.csv</code> file shows the different formats of how the dates were stored in the original <code>.csv</code> file and imported into the R object <code>d1</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">  <span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(d1, <span class="dv">2</span>)  <span class="co"># examine dataframe</span></a></code></pre></div>
<pre><code>##       date1   date2     date3
## 1  5/5/2003  5/5/03  5-May-03
## 2 7/11/2002 7/11/02 11-Jul-02</code></pre>
<p>Next, <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> returns the class of all the dates, which for all variables in this example is of R class <code>Factor</code>. As we will see below, the <code>class</code> determination is of importance when converting dates and times to their R–based analogues.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">  <span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(d1) <span class="co"># examine class of MS excel dates imported into R</span></a></code></pre></div>
<pre><code>## 'data.frame':    10 obs. of  3 variables:
##  $ date1: Factor w/ 10 levels "10/18/2003","5/5/2003",..: 2 4 6 7 1 5 3 10 8 9
##  $ date2: Factor w/ 10 levels "10/18/03","5/5/03",..: 2 4 6 7 1 5 3 10 8 9
##  $ date3: Factor w/ 10 levels "08-Aug-04","11-Jul-02",..: 10 2 4 9 5 3 7 8 1 6</code></pre>
<p>The trick, then, is to convert these <code>.csv</code> date formats into an R date format, thereby allowing access to a host of R functions that can use R–formatted dates.</p>
</div>
<div id="so-how-do-i-create-rbased-date-and-time-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#so-how-do-i-create-rbased-date-and-time-objects" class="anchor"></a>So How Do I Create R–based Date and Time Objects?</h2>
<p>There are several packages for creating date and time formats in R. These include, but are not limited to, functions within the R <a href="https://www.rdocumentation.org/packages/base/versions/3.5.1/topics/as.Date" target="blank"><code>base</code></a> packages, <a href="https://cran.r-project.org/web/packages/chron/index.html" target="blank"><code>chron</code></a>, <a href="https://lubridate.tidyverse.org/" target="blank"><code>lubridate</code></a>, <a href="https://cran.r-project.org/web/packages/xlsx/index.html" target="blank"><code>xlsx</code></a>, and <a href="https://cran.r-project.org/web/packages/readxl/index.html" target="blank"><code>readxl</code></a>.</p>
</div>
<div id="the-base-package-using-the-as-date-function" class="section level2">
<h2 class="hasAnchor">
<a href="#the-base-package-using-the-as-date-function" class="anchor"></a>The base Package: Using the as.Date Function</h2>
<p>Before proceeding further, recall from above that the class of <code>date1</code>, <code>date2</code>, and <code>date3</code> was that of<code>Factor</code>. Do other R classes work with <code>as.Date</code> as well? If so, what are these?</p>
<p>The required class for <code>as.Date</code> is character. In this case, <code>Factor</code> is a character set as well, so the <code>as.Date</code> conversion will work. To be safe, however, you could apply <code>as.character</code> coercion to the data, thereby ensuring with certainty that the input values are of class <code>chr</code>. We’ll see an example of that below.</p>
<p>The <code>as.Date</code> process assumes a default input format of YYYY–MM–DD, such as “2017-10-6”. Thus, if your data input is <strong>not</strong> in that format after importation into R, errors in the conversion will occur and you might not be aware of them!</p>
<p>For example, note below that the variable <code>date1</code> gets converted, but for the first datum the year “2003”" was converted to year “0005”, or a date approximately 2 millennia ago! Others are converted to <code>NA</code>, an appropriate value as far as R is concerned but clearly wrong in terms of the dates in the original <code>.csv</code> file.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># what happens if wrong date format assumed?</span></a>
<a class="sourceLine" id="cb5-2" title="2">  <span class="kw"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(d1<span class="op">$</span>date1)  <span class="co"># conversion without proper formatting</span></a></code></pre></div>
<pre><code>##  [1] "0005-05-20" "0007-11-20" NA           NA           NA          
##  [6] "0007-12-20" NA           NA           "0008-08-20" NA</code></pre>
<p>The solution is to use the <code>format =</code> option within <code>as.Date</code> and specify how the format of the input dates looks. These options are shown in (Fig. @ref(fig:fig02)). The solution is simple – pick the one that mimics your import data and use that in the <code>format =</code> option.</p>
<!-- ![](figures/datetimeoptions.png){width=480px} --->
<div class="figure" style="text-align: center">
<img src="figures/datetimeoptions.png" alt="R--based input format options for date" width="65%" style="background-color: #ffffff; padding:10px; display: inline-block;"><p class="caption">
R–based input format options for date
</p>
</div>
<p>So if the input format of <code>date1</code> is ….</p>
<pre><code>##  [1] 5/5/2003   7/11/2002  8/17/2004  8/31/2003  10/18/2003 7/12/2003 
##  [7] 6/30/2005  9/30/2004  8/8/2004   9/29/2004 
## 10 Levels: 10/18/2003 5/5/2003 6/30/2005 7/11/2002 7/12/2003 ... 9/30/2004</code></pre>
<p>… then the appropriate format option for conversion to a R-based date is <code>format = "%m/%d/%Y"</code>, given the coding options shown in the table above. This results in a correct conversion of your input dates to an R date.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># convert input format of date1 using format=</span></a>
<a class="sourceLine" id="cb8-2" title="2">  <span class="kw"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(d1<span class="op">$</span>date1, <span class="dt">format =</span> <span class="st">"%m/%d/%Y"</span>)</a></code></pre></div>
<pre><code>##  [1] "2003-05-05" "2002-07-11" "2004-08-17" "2003-08-31" "2003-10-18"
##  [6] "2003-07-12" "2005-06-30" "2004-09-30" "2004-08-08" "2004-09-29"</code></pre>
<p><strong>NOTE</strong> that in the next conversion we apply the <code>as.character</code> wrapper as well, thereby temporarily coercing <code>date1</code> to character class before the conversion to a R–based date. Both result in correct conversions.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># convert input format of date1 using as.character &amp; format=</span></a>
<a class="sourceLine" id="cb10-2" title="2">  <span class="kw"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(d1<span class="op">$</span>date1), <span class="dt">format =</span> <span class="st">"%m/%d/%Y"</span>)</a></code></pre></div>
<pre><code>##  [1] "2003-05-05" "2002-07-11" "2004-08-17" "2003-08-31" "2003-10-18"
##  [6] "2003-07-12" "2005-06-30" "2004-09-30" "2004-08-08" "2004-09-29"</code></pre>
<p>For <code>date3</code>, which is of input format “5-May-03”, the conversion catechism from the table above is “%d-%b-%y”.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># convert the input format of date3 using format=</span></a>
<a class="sourceLine" id="cb12-2" title="2">  <span class="kw"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(d1<span class="op">$</span>date3, <span class="dt">format =</span> <span class="st">"%d-%b-%y"</span>)</a></code></pre></div>
<pre><code>##  [1] "2003-05-05" "2002-07-11" "2004-08-17" "2003-08-31" "2003-10-18"
##  [6] "2003-07-12" "2005-06-30" "2004-09-30" "2004-08-08" "2004-09-29"</code></pre>
<p>Simple enough, right?</p>
<p>To ensure proper conversion you need to remember the <code>class</code> of the date input – both <code>Factor</code> and <code>chr</code> work – and ensure you have told R the format of the input date data. Personally, I always add the converted date as a new variable to the data frame, thereby ensuring I still have the original values as well. Your call, but here’s one way to do it.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co"># convert the input format of dates &amp; add to dataframe</span></a>
<a class="sourceLine" id="cb14-2" title="2">  d1<span class="op">$</span>r.date1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(d1<span class="op">$</span>date1, <span class="dt">format =</span> <span class="st">"%m/%d/%Y"</span>)</a>
<a class="sourceLine" id="cb14-3" title="3">  d1<span class="op">$</span>r.date2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(d1<span class="op">$</span>date2, <span class="dt">format =</span> <span class="st">"%m/%d/%y"</span>)</a>
<a class="sourceLine" id="cb14-4" title="4">  d1<span class="op">$</span>r.date3 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(d1<span class="op">$</span>date3, <span class="dt">format =</span> <span class="st">"%d-%b-%y"</span>)</a>
<a class="sourceLine" id="cb14-5" title="5">  <span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(d1, <span class="dv">2</span>)  <span class="co"># examine dataframe</span></a></code></pre></div>
<pre><code>##       date1   date2     date3    r.date1    r.date2    r.date3
## 1  5/5/2003  5/5/03  5-May-03 2003-05-05 2003-05-05 2003-05-05
## 2 7/11/2002 7/11/02 11-Jul-02 2002-07-11 2002-07-11 2002-07-11</code></pre>
<p>One last observation. Once converted to a date format, the <code>class</code> becomes <code>Date</code> for the three new variables as shown below.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># examine dataframe and var structure</span></a>
<a class="sourceLine" id="cb16-2" title="2">  <span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(d1)</a></code></pre></div>
<pre><code>## 'data.frame':    10 obs. of  6 variables:
##  $ date1  : Factor w/ 10 levels "10/18/2003","5/5/2003",..: 2 4 6 7 1 5 3 10 8 9
##  $ date2  : Factor w/ 10 levels "10/18/03","5/5/03",..: 2 4 6 7 1 5 3 10 8 9
##  $ date3  : Factor w/ 10 levels "08-Aug-04","11-Jul-02",..: 10 2 4 9 5 3 7 8 1 6
##  $ r.date1: Date, format: "2003-05-05" "2002-07-11" ...
##  $ r.date2: Date, format: "2003-05-05" "2002-07-11" ...
##  $ r.date3: Date, format: "2003-05-05" "2002-07-11" ...</code></pre>
<p>You’re done!</p>
</div>
<div id="using-the-chron-package-both-date-and-time" class="section level2">
<h2 class="hasAnchor">
<a href="#using-the-chron-package-both-date-and-time" class="anchor"></a>Using the <code>chron</code> Package: Both Date and Time</h2>
<p>If you plan to use time, either as a standalone variable or combined with date into a date:time variable, consider the <code>chron</code> package.</p>
<p><code>chron</code>, and its <code>dates</code> and <code>times</code> functions, has the advantage over the base <code>as.Date</code> given it can handle both date and time in one convenient call. It can create a date:time object of “year:month:day:hour:minute:second” format. This object can, as with values from <code>as.Date</code>, be subjected to a variety of arithmetic operations.</p>
<div id="date-in-chron" class="section level3">
<h3 class="hasAnchor">
<a href="#date-in-chron" class="anchor"></a>Date in <code>chron</code>
</h3>
<p>Consider the data below, which consist of both a date column and a time column. As above, we have date imported with a particular format – not the default R format – and now have a time format of “HH:MM:SS”. <code>str</code> indicates both are of class <code>Factor</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># import some date formats from .csv file</span></a>
<a class="sourceLine" id="cb18-2" title="2">  d2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="st">"data/datetimeformats.csv"</span>, <span class="dt">header =</span> T)</a>
<a class="sourceLine" id="cb18-3" title="3">  <span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(d2, <span class="dv">2</span>)  <span class="co"># examine dataframe</span></a></code></pre></div>
<pre><code>##        date     time
## 1 2/27/1991 13:08:40
## 2 2/27/1991 13:09:04</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">  <span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(d2)  <span class="co"># dataframe structure</span></a></code></pre></div>
<pre><code>## 'data.frame':    10 obs. of  2 variables:
##  $ date: Factor w/ 1 level "2/27/1991": 1 1 1 1 1 1 1 1 1 1
##  $ time: Factor w/ 10 levels "13:08:40","13:09:04",..: 1 2 3 4 5 6 7 8 9 10</code></pre>
<p>The two basic calls in <code>chron</code> are <code>dates</code>, which as the name implies converts dates into to a R–based date format, and <code>times</code>, which does the same for time formats. Although class <code>factor</code> was considered as character using <code>as.Date</code>, this is not the case for the <code>dates</code> call. The input date values must be coerced into class <code>chr</code> before <code>dates</code> will work. Simply applying <code>dates</code> without the date being of class <code>chr</code> will return an error.</p>
</div>
<div id="time-in-chron" class="section level3">
<h3 class="hasAnchor">
<a href="#time-in-chron" class="anchor"></a>Time in <code>chron</code>
</h3>
<p>For reasons beyond this mere mortal’s comprehension, <code>times</code> does <strong>not</strong> require coercion to class <code>chr</code> but works okay with class <code>Factor</code>. As with <code>as.Date</code>, both <code>dates</code> and <code>times</code> can accept inputs of differing formats. These are specified in the <code>chron</code> option <code>format = c(dates = , times = )</code>. <code>dates =</code> is of any YYYY:MM:DD sequence. <code>times =</code> can be in any permutation of HH:MM:SS separated by non–special characters like “:” or “-”. See <code><a href="https://rdrr.io/r/utils/help.html">help(chron)</a></code> for specifics; not all format options are presented here.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># convert some date &amp; time formats using chron</span></a>
<a class="sourceLine" id="cb22-2" title="2">  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(chron)  <span class="co"># load chron library</span></a>
<a class="sourceLine" id="cb22-3" title="3">  <span class="kw"><a href="https://rdrr.io/pkg/chron/man/dates.html">dates</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(d2<span class="op">$</span>date))  <span class="co"># convert to chron date</span></a></code></pre></div>
<pre><code>##  [1] 02/27/91 02/27/91 02/27/91 02/27/91 02/27/91 02/27/91 02/27/91
##  [8] 02/27/91 02/27/91 02/27/91</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">  <span class="kw"><a href="https://rdrr.io/pkg/chron/man/dates.html">times</a></span>(d2<span class="op">$</span>time)  <span class="co"># convert to chron time</span></a></code></pre></div>
<pre><code>##  [1] 13:08:40 13:09:04 13:09:19 13:09:29 13:09:42 13:09:53 13:10:00
##  [8] 13:10:03 13:10:31 13:10:41</code></pre>
<p>You can also combine the <code>chron</code> functions into a single call as shown below. Note how the combined date:time is portrayed in the output.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># convert some date &amp; time formats using chron</span></a>
<a class="sourceLine" id="cb26-2" title="2">  <span class="kw"><a href="https://rdrr.io/pkg/chron/man/chron.html">chron</a></span>(<span class="dt">dates =</span> <span class="kw"><a href="https://rdrr.io/pkg/chron/man/dates.html">dates</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(d2<span class="op">$</span>date)), </a>
<a class="sourceLine" id="cb26-3" title="3">   <span class="dt">times =</span> <span class="kw"><a href="https://rdrr.io/pkg/chron/man/dates.html">times</a></span>(d2<span class="op">$</span>time)) <span class="co"># both chron date time</span></a></code></pre></div>
<pre><code>##  [1] (02/27/91 13:08:40) (02/27/91 13:09:04) (02/27/91 13:09:19)
##  [4] (02/27/91 13:09:29) (02/27/91 13:09:42) (02/27/91 13:09:53)
##  [7] (02/27/91 13:10:00) (02/27/91 13:10:03) (02/27/91 13:10:31)
## [10] (02/27/91 13:10:41)</code></pre>
<p>As indicated above, these conversions could be added to the dataframe if desired.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co"># build new dataframe and examine structure</span></a>
<a class="sourceLine" id="cb28-2" title="2">  d2<span class="op">$</span>c.date &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/chron/man/dates.html">dates</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(d2<span class="op">$</span>date))</a>
<a class="sourceLine" id="cb28-3" title="3">  d2<span class="op">$</span>c.time &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/chron/man/dates.html">times</a></span>(d2<span class="op">$</span>time)</a>
<a class="sourceLine" id="cb28-4" title="4">  d2<span class="op">$</span>c.datetime &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/chron/man/chron.html">chron</a></span>(<span class="dt">dates =</span> <span class="kw"><a href="https://rdrr.io/pkg/chron/man/dates.html">dates</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(d2<span class="op">$</span>date)), </a>
<a class="sourceLine" id="cb28-5" title="5">   <span class="dt">times =</span> <span class="kw"><a href="https://rdrr.io/pkg/chron/man/dates.html">times</a></span>(d2<span class="op">$</span>time))</a>
<a class="sourceLine" id="cb28-6" title="6">  <span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(d2, <span class="dv">2</span>)  <span class="co"># examine dataframe</span></a></code></pre></div>
<pre><code>##        date     time   c.date   c.time          c.datetime
## 1 2/27/1991 13:08:40 02/27/91 13:08:40 (02/27/91 13:08:40)
## 2 2/27/1991 13:09:04 02/27/91 13:09:04 (02/27/91 13:09:04)</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">  <span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(d2)  <span class="co"># examine data structure</span></a></code></pre></div>
<pre><code>## 'data.frame':    10 obs. of  5 variables:
##  $ date      : Factor w/ 1 level "2/27/1991": 1 1 1 1 1 1 1 1 1 1
##  $ time      : Factor w/ 10 levels "13:08:40","13:09:04",..: 1 2 3 4 5 6 7 8 9 10
##  $ c.date    : 'dates' num  02/27/91 02/27/91 02/27/91 02/27/91 02/27/91 ...
##   ..- attr(*, "origin")= Named num  1 1 1970
##   .. ..- attr(*, "names")= chr  "month" "day" "year"
##  $ c.time    : 'times' num  13:08:40 13:09:04 13:09:19 13:09:29 13:09:42 ...
##   ..- attr(*, "format")= chr "h:m:s"
##  $ c.datetime: 'chron' num  (02/27/91 13:08:40) (02/27/91 13:09:04) (02/27/91 13:09:19) (02/27/91 13:09:29) (02/27/91 13:09:42) ...
##   ..- attr(*, "format")= Named chr  "m/d/y" "h:m:s"
##   .. ..- attr(*, "names")= chr  "dates" "times"
##   ..- attr(*, "origin")= Named num  1 1 1970
##   .. ..- attr(*, "names")= chr  "month" "day" "year"</code></pre>
<p><strong>NOTE</strong> that <code>chron</code> creates a different class than does <code>as.Date</code>, as well as storing dates in a different R–based format. This internal R format keeps track of all the year to seconds elements of the date:time objects.</p>
</div>
</div>
<div id="the-lubridate-package-your-best-bet-for-date-and-time" class="section level2">
<h2 class="hasAnchor">
<a href="#the-lubridate-package-your-best-bet-for-date-and-time" class="anchor"></a>The <code>lubridate</code> Package: Your Best Bet for Date and Time</h2>
<div id="dealing-with-dates" class="section level3">
<h3 class="hasAnchor">
<a href="#dealing-with-dates" class="anchor"></a>Dealing with Dates</h3>
<p>Let’s start again with a fresh set of dates, re–importing the same dataset we employed for the call <code>as.Date</code> from the base package. We’ll call it <code>d3</code> this time.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">  <span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(d3, <span class="dv">2</span>)  <span class="co"># examine dataframe</span></a></code></pre></div>
<pre><code>##       date1   date2     date3
## 1  5/5/2003  5/5/03  5-May-03
## 2 7/11/2002 7/11/02 11-Jul-02</code></pre>
<p>Conversion for combinations of day, month, and year using <code>lubridate</code> is quite simple – examine the sequencing of of the input format, where day = <code>d</code>, month = <code>m</code>, and year = <code>y</code>, and employ <code>lubridate</code> functions based on the sequencing of the three letters, <code>d</code>, <code>m</code>, and <code>y</code>. Thus <code>dmy</code> is for day–month–year, <code>mdy</code> for month–day–year, and so forth for all the sequencing combinations. There is no need to apply a <code>format =</code> option as we did when using <code>as.Date</code> !! <code>lubridate</code> automatically handles those conversions internally.</p>
<p><strong>NOTE</strong> the default input functions of <code>lubridate</code> return data of <code>class = Date</code>. See <code><a href="https://rdrr.io/r/utils/help.html">help(lubridate)</a></code> or <code><a href="https://rdrr.io/r/utils/help.html">help(dmy)</a></code> (or any the <code>d</code>, <code>m</code>, <code>y</code> sequences) for differenrt <code>class =</code> and other options.</p>
<p><strong>Yet Another NOTE</strong> is that <code>lubridate</code> masks quite a few other functions. Consequently below I’m using the <code>package::function</code> method.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="co">#library(lubridate)</span></a>
<a class="sourceLine" id="cb34-2" title="2">d3<span class="op">$</span>r.date1 &lt;-<span class="st"> </span>lubridate<span class="op">::</span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/ymd.html">mdy</a></span>(d3<span class="op">$</span>date1) <span class="co"># input format: 5/5/2003</span></a>
<a class="sourceLine" id="cb34-3" title="3">d3<span class="op">$</span>r.date2 &lt;-<span class="st"> </span>lubridate<span class="op">::</span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/ymd.html">mdy</a></span>(d3<span class="op">$</span>date2) <span class="co"># input format: 5/5/03</span></a>
<a class="sourceLine" id="cb34-4" title="4">d3<span class="op">$</span>r.date3 &lt;-<span class="st"> </span>lubridate<span class="op">::</span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span>(d3<span class="op">$</span>date3) <span class="co"># input format: 5-May-03</span></a>
<a class="sourceLine" id="cb34-5" title="5"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(d3, <span class="dv">2</span>) <span class="co"># examine dataframe</span></a></code></pre></div>
<pre><code>##       date1   date2     date3    r.date1    r.date2    r.date3
## 1  5/5/2003  5/5/03  5-May-03 2003-05-05 2003-05-05 2003-05-05
## 2 7/11/2002 7/11/02 11-Jul-02 2002-07-11 2002-07-11 2002-07-11</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(d3) <span class="co"># dataframe structure</span></a></code></pre></div>
<pre><code>## 'data.frame':    10 obs. of  6 variables:
##  $ date1  : Factor w/ 10 levels "10/18/2003","5/5/2003",..: 2 4 6 7 1 5 3 10 8 9
##  $ date2  : Factor w/ 10 levels "10/18/03","5/5/03",..: 2 4 6 7 1 5 3 10 8 9
##  $ date3  : Factor w/ 10 levels "08-Aug-04","11-Jul-02",..: 10 2 4 9 5 3 7 8 1 6
##  $ r.date1: Date, format: "2003-05-05" "2002-07-11" ...
##  $ r.date2: Date, format: "2003-05-05" "2002-07-11" ...
##  $ r.date3: Date, format: "2003-05-05" "2002-07-11" ...</code></pre>
<p>Simple enough!</p>
</div>
<div id="consider-time" class="section level3">
<h3 class="hasAnchor">
<a href="#consider-time" class="anchor"></a>Consider Time</h3>
<p>Time is added in a similar fashion using labels of <code>h</code> = hour, <code>m</code> = minute, and <code>s</code> = seconds. Thus, to mimic <code>chron</code>’s date:time capability, apply the call <code>mdy_hms</code>.</p>
<p>Consider again the data below, which consists of two columns, one of <strong>date</strong> in MMM/DD/YYYY and one of <strong>time</strong> in HH:MM:SS. (Remember, the variants in the <code>m</code>, <code>d</code>, and <code>y</code> depend on the sequencing of the input data.) For the <code>mdy_hms</code> to work the date and time must first be concatenated using <code>paste</code>, and then the <code>mdy_hms</code> call applied.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">  <span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(d4, <span class="dv">2</span>)  <span class="co"># examine dataframe</span></a></code></pre></div>
<pre><code>##        date     time
## 1 2/27/1991 13:08:40
## 2 2/27/1991 13:09:04</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">  d4<span class="op">$</span>r.datetime &lt;-<span class="st"> </span>lubridate<span class="op">::</span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/ymd_hms.html">mdy_hms</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(d4<span class="op">$</span>date, d4<span class="op">$</span>time, <span class="dt">sep =</span> <span class="st">" "</span>)) <span class="co"># date-time</span></a>
<a class="sourceLine" id="cb40-2" title="2">  <span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(d4)  <span class="co"># dataframe structure</span></a></code></pre></div>
<pre><code>## 'data.frame':    10 obs. of  3 variables:
##  $ date      : Factor w/ 1 level "2/27/1991": 1 1 1 1 1 1 1 1 1 1
##  $ time      : Factor w/ 10 levels "13:08:40","13:09:04",..: 1 2 3 4 5 6 7 8 9 10
##  $ r.datetime: POSIXct, format: "1991-02-27 13:08:40" "1991-02-27 13:09:04" ...</code></pre>
<p>Once again, you’re done !! You now have an alternative (and somewhat easier) way to create data. time, and date:time variables for use in R analyses. The only other <strong>NOTE</strong> is <code>class</code> is no longer <code>Date</code>, but that of <code>POSIXct</code>. We’ll discuss <code>POSIXct</code> and it’s cousin <code>POSIXlt</code> below.</p>
<hr>
</div>
</div>
<div id="importing-date-and-time-from-ms-excel--xlsx--xls-files" class="section level2">
<h2 class="hasAnchor">
<a href="#importing-date-and-time-from-ms-excel--xlsx--xls-files" class="anchor"></a>Importing Date and Time from MS Excel .xlsx / .xls Files</h2>
<p>Okay, I get it.</p>
<p>Some of you just can’t let go of MS EXCEL products. So let’s see what happens using dates and times imported directly from <code>.xls/.xlsx</code> files using two different packages, <code>xlsx</code> and <code>readxl</code>. <strong>NOTE</strong> that the second package is the “default” GUI importation for <code>.xls/.xlsx</code> files in RStudio.</p>
</div>
<div id="package-xlsx-and-date-and-time" class="section level2">
<h2 class="hasAnchor">
<a href="#package-xlsx-and-date-and-time" class="anchor"></a>Package <code>xlsx</code> and Date and Time</h2>
<p>Quoting directly from the <code>xlsx</code> package as developed by Adrian A. Dragulescu, “<em>The xlsx package gives programatic control of Excel files using R [and] allows the user to read a sheet of an xlsx document into a data.frame and write a data.frame to a file.</em>” While <code>xlsx</code> works fine with simple numeric and character data types, how well does it deal with dates and times? First, <strong>NOTE</strong> that you will need the <code>rJava</code> and <code>xlsxjars</code> R packages installed, as well as both 32– and 64–bit versions of Java to support the <code>xlsx</code> package.</p>
<div id="importation-of-dates-from-ms-excel" class="section level3">
<h3 class="hasAnchor">
<a href="#importation-of-dates-from-ms-excel" class="anchor"></a>Importation of Dates from MS EXCEL</h3>
<p>Notice that data object <code>d3</code> contains variables <strong>date2</strong> and <strong>date3</strong>, which were of <code>.xlsx</code> formats of “5/5/03” and “5-May-03,” respectively, and which were automatically converted to the “YYYY–MM–DD” R format. <code>date1</code> was not.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">  <span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(d3, <span class="dv">2</span>)  <span class="co"># examine import from .xlsx</span></a></code></pre></div>
<pre><code>##       date1      date2      date3
## 1  5/5/2003 2003-05-05 2003-05-05
## 2 7/11/2002 2002-07-11 2002-07-11</code></pre>
<p>In addition, the class is now <code>Date</code>, which is identical to that after earlier conversions using <code>as.Date</code> above.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="co"># examine structure after .xlsx import</span></a>
<a class="sourceLine" id="cb44-2" title="2">  <span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(d3)</a></code></pre></div>
<pre><code>## 'data.frame':    10 obs. of  3 variables:
##  $ date1: Factor w/ 10 levels "10/18/2003","5/5/2003",..: 2 4 6 7 1 5 3 10 8 9
##  $ date2: Date, format: "2003-05-05" "2002-07-11" ...
##  $ date3: Date, format: "2003-05-05" "2002-07-11" ...</code></pre>
<p>Bottom line is that while direct import of a <code>.xlsx</code> file with dates works for some date formats, it does not work for all, and conversions similar to those shown for dates imported using <code>.csv</code> files (e.g., <code>as.Date</code>) will still have to be used in some cases. So other than being aware you might need to apply a format option to some types of dates, the result is not too different from importation of dates from a <code>.csv</code> file.</p>
</div>
<div id="but-what-about-time" class="section level3">
<h3 class="hasAnchor">
<a href="#but-what-about-time" class="anchor"></a>But What About Time?</h3>
<p>Well, there seems to be an issue when time is a standalone variable (i.e., without an associated date value) is imported, the most obvious being some sort of date – “1899-12-30”, the next–to–last day of the 19th century? – now associated with the time stamp of “13:08:40.” Variable <code>datetime</code>, a combined date and time format, looks okay and mirrors the raw data format of the <code>.xlsx</code> file. In addition, we see a new R class for time – the <code>POSIXct</code> – for both <code>time</code> and <code>datetime</code>.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">  <span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(d4, <span class="dv">2</span>) <span class="co"># examine dataframe</span></a></code></pre></div>
<pre><code>##         date                time
## 1 1991-02-27 1899-12-30 13:08:40
## 2 1991-02-27 1899-12-30 13:09:04</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1">  <span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(d4)</a></code></pre></div>
<pre><code>## 'data.frame':    10 obs. of  2 variables:
##  $ date: Date, format: "1991-02-27" "1991-02-27" ...
##  $ time: POSIXct, format: "1899-12-30 13:08:40" "1899-12-30 13:09:04" ...</code></pre>
<p>But before diving into the murky world of <code>POSIXct</code>, and its cousin <code>POSIXlt</code>, let’s see how another direct import of <code>.xlsx/.xls</code> files deals with the same dates and times.</p>
</div>
</div>
<div id="package-readxl-and-date-and-time" class="section level2">
<h2 class="hasAnchor">
<a href="#package-readxl-and-date-and-time" class="anchor"></a>Package <code>readxl</code> and Date and Time</h2>
<p>This package also directly imports MS EXCEL sheets, and is the GUI–driven drop–down default package for MS EXCEL imports in RStudio as well.</p>
<div id="back-to-dates-aagin" class="section level3">
<h3 class="hasAnchor">
<a href="#back-to-dates-aagin" class="anchor"></a>Back to Dates Aagin</h3>
<p>As with <code>read.xlsx</code>, the <code>read_xlsx</code> function within package <code>readxl</code> properly converted <code>date2</code> and <code>date3</code> to R’s “YYYY–MM–DD” format. However, the same cautionary note from package <code>xlsx</code> also applies – not all date formats will be correctly imported and additional functions such as <code>as.Date</code> may be required.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">  d5 &lt;-<span class="st"> </span><span class="kw">read_xlsx</span>(<span class="st">"data/dateformats.xlsx"</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb50-2" title="2">  <span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(d5, <span class="dv">2</span>)  <span class="co"># examine dataframe</span></a></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   date1     date2               date3              
##   &lt;chr&gt;     &lt;dttm&gt;              &lt;dttm&gt;             
## 1 5/5/2003  2003-05-05 00:00:00 2003-05-05 00:00:00
## 2 7/11/2002 2002-07-11 00:00:00 2002-07-11 00:00:00</code></pre>
<p>Applying <code>str</code> to the imported object <code>d5</code> returns, as with <code>read.xl</code> above, a class of <code>POSIXct</code> for the date values. Once again we see a new and different class resulting from data imports directly from <code>.xlsx/.xls</code> files.</p>
<pre><code>## Classes 'tbl_df', 'tbl' and 'data.frame':    10 obs. of  3 variables:
##  $ date1: chr  "5/5/2003" "7/11/2002" "8/17/2004" "8/31/2003" ...
##  $ date2: POSIXct, format: "2003-05-05" "2002-07-11" ...
##  $ date3: POSIXct, format: "2003-05-05" "2002-07-11" ...</code></pre>
</div>
<div id="and-what-about-timerelated-values" class="section level3">
<h3 class="hasAnchor">
<a href="#and-what-about-timerelated-values" class="anchor"></a>And What About Time–Related Values?</h3>
<p>Once again note that a strange year – “1899-12-31” – has been added to the <code>time</code> import format of HH:MM:SS, while <code>datetime</code> once again looks okay. However, the date added is for “31 Dec 1899,” not “30 Dec 1899.” But unlike in package <code>xlsx</code> above, which imports variable <code>date</code> as class <code>Date</code>, and variables <code>time</code> and <code>datetime</code> as class <code>PSOXct</code>, package <code>readxl</code> at least converts all three variables to class <code>POSIXct</code>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">  <span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(d6, <span class="dv">2</span>)  <span class="co"># examine dataframe</span></a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   date                time               
##   &lt;dttm&gt;              &lt;dttm&gt;             
## 1 1991-02-27 00:00:00 1899-12-31 13:08:40
## 2 1991-02-27 00:00:00 1899-12-31 13:09:04</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">  <span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(d6)</a></code></pre></div>
<pre><code>## Classes 'tbl_df', 'tbl' and 'data.frame':    10 obs. of  2 variables:
##  $ date: POSIXct, format: "1991-02-27" "1991-02-27" ...
##  $ time: POSIXct, format: "1899-12-31 13:08:40" "1899-12-31 13:09:04" ...</code></pre>
<p>What’s going on with <code>time</code>? And what does class <code>POSIXct</code> have to do with both date, time, and date:time R formats? Is this an issue related only to direct importation of <code>.xlsx/.xls</code> files? Why do two packages that purportedly import <code>.xlsx/xls</code> files directly lead to different R classes, as well as, in at least for <code>time</code>, different dates being added?</p>
<hr>
</div>
</div>
<div id="the-r-classes-of-posixct-and-posixlt" class="section level2">
<h2 class="hasAnchor">
<a href="#the-r-classes-of-posixct-and-posixlt" class="anchor"></a>The R Classes of <code>POSIXct</code> and <code>POSIXlt</code>
</h2>
<p>Both of these R classes deal with calendar date and time.</p>
<p>The first, <code>POSIXct</code>, represents a date as the number of positive seconds from R’s arbitrary start date of 1 January 1970, or negative seconds going backward in date from there. The seconds are pegged to Greenwich Mean Time (or Universal Time Coordinated) meaning the value is off by seven hours (25,200 seconds) given my location in Utah, ignoring daylight savings effects for now.</p>
<p><code>POSIXlt</code> is a list of vectors including, in sequence, those for (1) seconds, (2) minutes, (3) hours, (4) day of month, (5) month (Note: January = 0), (6) year since 1900, (7) day of week (Note: Sunday = 0), (8) year of day (Note 1 January = 0), and (9) a flag for daylight savings time.</p>
<p>Both formats allow for arithmetic operations, and any date elements such the year or month or hour can be extracted. Extraction examples from each are shown below, bearing in mind that <code>POSIXlt</code> is a list and, as such, values must be extracted using R list notation. As part of the extraction examples, we convert the <code>POSIXct</code> format to <code>POSIXlt</code> and then extract the hour, minutes, and seconds vectors.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="co"># extract elements from POSIXct and POSIXlt formats </span></a>
<a class="sourceLine" id="cb57-2" title="2">  <span class="kw"><a href="https://rdrr.io/r/base/format.html">format</a></span>(d6<span class="op">$</span>date, <span class="st">"%Y"</span>)  <span class="co"># extract year from a POSIXct date</span></a></code></pre></div>
<pre><code>##  [1] "1991" "1991" "1991" "1991" "1991" "1991" "1991" "1991" "1991" "1991"</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1">  <span class="kw"><a href="https://rdrr.io/r/base/format.html">format</a></span>(d6<span class="op">$</span>time, <span class="st">"%H"</span>)  <span class="co"># extract hour from POSIXct time</span></a></code></pre></div>
<pre><code>##  [1] "13" "13" "13" "13" "13" "13" "13" "13" "13" "13"</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="co"># convert POSIXct to POSIXlt format</span></a>
<a class="sourceLine" id="cb61-2" title="2">  d6<span class="op">$</span>plt.datetime &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXlt</a></span>(d6<span class="op">$</span>time)</a>
<a class="sourceLine" id="cb61-3" title="3">  d6<span class="op">$</span>plt.datetime[<span class="dv">1</span> ,] <span class="co"># examine 1st obs</span></a></code></pre></div>
<pre><code>## [1] "1899-12-31 13:08:40 UTC"</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1">  <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(d6<span class="op">$</span>plt.datetime[[<span class="dv">1</span>]])  <span class="co"># extract all elements of 1st obs</span></a></code></pre></div>
<pre><code>##   sec   min  hour  mday   mon  year  wday  yday isdst 
##    40     8    13    31    11    -1     0   364     0</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1">  d6<span class="op">$</span>plt.datetime[, <span class="dv">2</span>] <span class="co"># extract mins - element 2 - from all obs</span></a></code></pre></div>
<pre><code>##  [1]  8  9  9  9  9  9 10 10 10 10</code></pre>
<p>We do have a clue here for the strange date of “1899-12-31” attached to our time values. Recall that our raw data column was simply a time of format HH:MM:SS. No date was attached. What the <code>.xlsx/.xls</code> imports of <code>read.xl</code> and <code>read_xlsx</code> do is automatically impose a date value onto data looking like a time value but without an accompanying date value. Specifically, it makes the conversion depending on how the data are actually stored in the <code>.xlsx/.xls</code> file. The <code>.xlsx</code> example here has time stored as a MS Excel format of “Custom” with structure “h:mm:ss.” Absent any attached date value, the start year defaults to of 1 January 1900, or essentially the last second of 31 December 1899.</p>
<p>Confusing?</p>
<p>You bet. Welcome to the world of co–mingling proprietary software with freeware.</p>
<p>Should you worry about this arbitrary fixed date of “1899-12-31” in this circumstance? The answer depends. If your intent is a comparison of times within a single day then the arbitrary date is of no consequence; merely perform your arithmetic operations since the date is a fixed scalar.</p>
<p>However, if the intent is to merge the standalone time column with a standalone date column, as we did above using <code>chron</code>, then you have a lot of coding manipulation to perform, such as first extracting the time elements as shown in the code above, then attaching that to the date, and then converting it to an appropriate R–based format. Whether this is worth the effort versus some other options shown here is your call.</p>
<hr>
</div>
<div id="some-summary-thoughts" class="section level2">
<h2 class="hasAnchor">
<a href="#some-summary-thoughts" class="anchor"></a>Some Summary Thoughts</h2>
<p>As with everything R–related, you solve the representation of date and time in R dependent on your own needs and approaches to data management and manipulation in R. Irrespective of that caveat, some thoughts to keep in mind, reflecting my personal solutions.</p>
<p>The first three things to keep in mind when dealing dates and time are:</p>
<ul>
<li>How the data are formatted in the raw, external file structure that is going to be imported into R;</li>
<li>What is the file type being imported, the two most common being either <code>.csv</code> or <code>.xlsx/.xls</code>; and</li>
<li>The intended operations to be performed on the date and time values.</li>
</ul>
<p>These three things lead to the following recommendations, which I cheerfully admit are personal and hence biased!</p>
<ul>
<li>
<code>.csv</code>–based date and time format and file type is the easiest to work with. It requires fewer coding manipulations to convert into R–based date and time formats. In this case package <code>lubridate</code> is perhaps easiest, although <code>chron</code> works equally well with for both date and time.</li>
<li>If you wish to live (and die??) by MS Excel file types, spend some time outside R and convert the MS Excel date, time, and date:time to the appropriate formats in Excel <strong>before</strong> importing them into R. Within Excel there are format options for dates and times, and the custom option can be used for date:time formats. And for some silly reason Excel works on a 12 hour clock with “AM” and “PM” labels. Go figure.</li>
<li>Of the two R packages that directly import <code>.xlsx/.xls</code> file type, package <code>readxl</code> is best, if only because it is the RStudio default and because date, time, and date:time date are imported by default as class <code>POSIXct</code>. No further conversions need be done.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#purpose-of-this-vignette">Purpose of this Vignette</a></li>
      <li><a href="#why-use-rbased-date-and-time-values">Why Use R–based Date and Time Values?</a></li>
      <li><a href="#the-datetime-conversion-process-in-r">The Date:Time Conversion Process in R</a></li>
      <li><a href="#importing-date-and-time-from--csv-files">Importing Date and Time from .csv Files</a></li>
      <li><a href="#so-how-do-i-create-rbased-date-and-time-objects">So How Do I Create R–based Date and Time Objects?</a></li>
      <li><a href="#the-base-package-using-the-as-date-function">The base Package: Using the as.Date Function</a></li>
      <li><a href="#using-the-chron-package-both-date-and-time">Using the <code>chron</code> Package: Both Date and Time</a></li>
      <li><a href="#the-lubridate-package-your-best-bet-for-date-and-time">The <code>lubridate</code> Package: Your Best Bet for Date and Time</a></li>
      <li><a href="#importing-date-and-time-from-ms-excel--xlsx--xls-files">Importing Date and Time from MS Excel .xlsx / .xls Files</a></li>
      <li><a href="#package-xlsx-and-date-and-time">Package <code>xlsx</code> and Date and Time</a></li>
      <li><a href="#package-readxl-and-date-and-time">Package <code>readxl</code> and Date and Time</a></li>
      <li><a href="#the-r-classes-of-posixct-and-posixlt">The R Classes of <code>POSIXct</code> and <code>POSIXlt</code></a></li>
      <li><a href="#some-summary-thoughts">Some Summary Thoughts</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Thomas Edwards.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
